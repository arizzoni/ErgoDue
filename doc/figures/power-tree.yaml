# diagram:
#   label: ErgoDue Power Architecture
#   label_position: top
#   font_family: Iosevka Aile
#   font_weight: bold
#   font_size: 18

rows:
  - [~, ~, vbus, micro, flash]
  - [~, ~, vbus, smps, microcontroller]
  - [~, ~, vbus, smps, gpio]
  - [~, ~, vbus, led, led0]
  - [input, protection_in, vbus, led, led1]
  - [~, ~, vbus, led, led2]
  - [~, ~, vbus, protection_out0, output0]
  - [~, ~, vbus, protection_out1, output1] 
  - [~, ~, vbus, protection_out2, output2] 

blocks:

  - name: vbus
    label: VBUS

  - name: smps
    label: 3.3V SMPS

  - name: led
    label: 5V SMPS

  - name: micro
    label: 1V1 SMPS

  - name: vee
    label: 1V1 RAIL

  - name: input
    label: Upstream USB-C Port

  - name: microcontroller
    label: Microcontroller

  - name: flash
    label: Flash Memory

  - name: output0
    label: Downstream USB-C Port

  - name: output1
    label: Downstream USB-C Port

  - name: output2
    label: Downstream USB-C Port

  - name: gpio
    label: GPIO Expander

  - name: led0
    label: LED Driver

  - name: led1
    label: LED Driver

  - name: led2
    label: LED Driver

  - name: protection_in
    label: Port Protection

  - name: protection_out0
    label: Port Protection

  - name: protection_out1
    label: Port Protection

  - name: protection_out2
    label: Port Protection

connections:

  - start: vbus
    end: smps

  - start: vbus
    end: micro

  - start: micro
    end: microcontroller

  - start: input
    end: protection_in

  - start: protection_in
    end: vbus
    middle_label: 5V, 3A

  - start: protection_out0
    end: output0

  - start: protection_out1
    end: output1

  - start: protection_out2
    end: output2

  - start: smps
    end: microcontroller

  - start: smps
    end: gpio

  - start: smps
    end: led0

  - start: smps
    end: led1

  - start: smps
    end: led2

  - start: led
    end: led0

  - start: led
    end: led1

  - start: led
    end: led2

  - start: vbus
    end: led

  - start: micro
    end: flash

  - start: vbus
    end: protection_out0

  - start: vbus
    end: protection_out1

  - start: vbus
    end: protection_out2

styles:
  
  default_block:
    font_family: Iosevka Aile Light
    fill: [0.95, 0.95, 0.95]

  default_connection:
    font_family: Iosevka Aile Light Oblique
    entrances: [LEFT]
    exits: [RIGHT]
